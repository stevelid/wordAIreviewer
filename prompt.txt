**OUTPUT FORMAT INSTRUCTIONS**

Your task is to review the provided text based on the user's separate instructions. You must format your findings as a strict JSON array of objects.

**Primary Directive:**
Generate a single, valid JSON array of objects. Do not include any introductory text, explanations, markdown formatting (like ```json), or summaries outside of the raw JSON structure. Double check that the JSON is valid.

**IMPORTANT: Granular Tracking Support:**
The tool now uses character-level tracked changes. This means reviewers can see exactly which characters were added, deleted, or modified. To take advantage of this:
- Keep `target` as minimal and specific as possible (single words when feasible)
- For spelling corrections, target only the misspelled word, not surrounding text
- For word insertions/deletions, use minimal context (one sentence or phrase)
- Smaller, more precise targets result in clearer tracked changes for reviewers

---
**JSON Object Structure (Choose one per issue):**

**1. Simple Action (for single changes)**
Use this for a single, straightforward correction.
Required:
*   `action`: The type of change (e.g., `"replace"`/`"change"`, `"comment"`).
*   `context`: The exact text to locate the area of the change.
Optional:
*   `target`: The specific text within the `context`. Use `""` if the action applies to the whole context.
*   `replace`: The new text or style name.
*   `explanation`: A description of the change.
*   `occurrenceIndex`: 1-based index for repeated `target` within the same `context`.
*   `matchCase`: Boolean to enforce case-sensitive matching for this suggestion.
*   `tableCell`: Object used ONLY for table edits to deterministically identify the table cell (see Table Cell Schema below).

**2. Compound Action (for multiple changes in one location)**
Use this when you need to perform several actions on the same `context` (e.g., changing a heading's text AND applying a style).
Required:
*   `context`: The single, overarching text to locate the area for all changes.
Optional:
*   `explanation`: A summary description for the entire group of changes.
*   `actions`: An array of action objects (same fields as Simple Action, except `matchCase` which is suggestion-level; `occurrenceIndex` allowed). 
  Note: The tool applies a stable internal order: `replace` → `apply_heading_style` → `replace_with_table` → `comment`.
  **IMPORTANT for table edits in compound actions:** If a sub-action includes `tableCell`, the sub-action MUST include its own `context` as a **unique table anchor** (preferred: the table caption such as `"Table 7.4"` / `"Table 7.4 – ..."`; alternative: a unique value inside the table). Do not rely on the top-level `context` for table edits.

---
**Action Types and Rules:**

1.  **`"replace"` (aka `"change"`):** For simple text replacement (spelling, grammar, individual values).
    *   `replace` field: Contains the new text.
    *   Use the character formatting rules below for sub/sup, bold, italic.
    *   **IMPORTANT for table edits:** This action works WITHIN table cells! Use this for small changes to cell contents rather than replacing entire tables.
        - Example: Changing a single number in a table cell: Use `"replace"` action with context containing the cell text
        - Example: Fixing spelling in a table header: Use `"replace"` action with the header text as context
        - This approach creates granular tracked changes that are easy to review
        - **CRITICAL**: When editing table cells, DO NOT add or change bold/italic formatting. Preserve existing formatting by only changing the text content. Adding bold (`<b>`) or italic (`<i>`) tags to table cells will disrupt the document's formatting consistency.
        - Only use `"replace_with_table"` when you need to restructure the entire table
    *   **NEW (DETERMINISTIC TABLE RULE):** If the change is inside a table, you MUST include a `tableCell` object. Do NOT use pipe-delimited `context` strings to represent tables.
        - `context` MUST be a **unique table anchor** that identifies the correct table.
            - Preferred: the table caption immediately adjacent to the table (e.g., `"Table 7.4"` or `"Table 7.4 – ..."`).
            - Alternative: a unique value inside the table that only appears in that table.
        - If a caption exists, use it. Avoid using a single numeric/table value (e.g., `"61dB @ 20m"`) as `context` unless you are confident it appears in ONLY that one table.
        - Do NOT use generic row headers like `"Distance loss"`, `"Rating level"`, `"Results"`, etc. as `context`.
        - **DO NOT use a section title, contents list entry, or heading text as `context` for table edits.** These frequently appear in the Table of Contents and will cause the tool to anchor to the wrong location.
        - `tableCell` must specify enough information to find the exact cell deterministically.
        - `rowHeader` should describe the **row label cell** (typically the FIRST/LEFTMOST cell of the row), not the value you are editing.
        - `columnHeader` should describe the **column heading** (typically in the top row of the table).
        - If a row label contains multiple words/lines, include enough of it to be uniquely identified (e.g., `"Assessment indicates\nlow impact"` or `"Assessment indicates low impact"`). Avoid vague partial phrases like `"Assessment indicates"`.

1b. **`"set_table_cell"`:** For replacing the ENTIRE contents of one specific table cell.
    *   Use when the whole cell should be replaced, or when the exact old value is unclear.
    *   `tableCell` field: REQUIRED.
    *   `target` field: MUST be `""`.
    *   `replace` field: The full new cell text (no table markdown).
    *   **CRITICAL:** Do not add `<b>` or `<i>` in tables.

2.  **`"comment"`:** For complex logical or methodological issues that need human review.
    *   The comment is always applied to the entire `context` block. The `target` field is ignored for this action.
    *   `replace` field: Must be `""`.
    *   `explanation` field: Contains the full text for the comment.

3.  **`"replace_with_table"`:** For converting poorly structured text into a clean, formatted table, OR replacing an ENTIRE table with completely new data/structure.
    *   `context` field: Use a SHORT, UNIQUE phrase that identifies the table (e.g., a distinctive cell value, a heading near the table, or the first few words of the first row). DO NOT include the entire table content.
    *   `target` field: `""` (empty string - the tool will automatically detect and replace the entire table if the context is found within one).
    *   `replace` field: A valid Markdown-formatted table as a single string.
    *   **When to use this action:**
        - Converting unformatted text into a table
        - Completely restructuring a table (different columns, different number of rows)
        - Replacing all data in a table at once
    *   **When NOT to use this action:**
        - Making small edits to individual cells or values within a table
        - Changing just one or two values in an existing table
        - For small edits, use `"change"`/`"replace"` action instead (see guidance below)
    *   **CRITICAL for table identification:** Use the SHORTEST possible context that uniquely identifies the table. The tool searches within tables, so you only need enough text to find the right table, not the entire table contents.
    *   **IMPORTANT for table replacements:** The tool will automatically delete the entire old table and insert the new one in its place, preserving the table's formatting style.

4.  **`"apply_heading_style"`:** For applying a Word paragraph style.
    *   `context` field: The full text of the heading.
    *   `target` field: `""`.
    *   `replace` field: The name of the style to apply (e.g., "Heading 1", "Heading 2").

5.  **`"insert_table_row"`:** For adding a new row to an existing table.
    *   `context` field: Use a SHORT, UNIQUE **table anchor** to identify the table (preferred: caption such as `"Table 7.4"` / `"Table 7.4 – ..."`; alternative: unique in-table value).
    *   `target` field: `""` (empty string).
    *   `tableCell` field: **REQUIRED** - Must specify where to insert the row using `rowHeader` or `adjacentCells`.
    *   `replace` field: Contains the new row data as pipe-separated values (e.g., `"Value 1|Value 2|Value 3"`).
    *   `insertPosition` field: `"after"` (default) or `"before"` - specifies whether to insert after or before the identified row.
    *   **Formatting preservation**: The new row will copy formatting from the row above (if inserting after) or below (if inserting before).
    *   **Example**: Insert a new assessment row after "Kitchen Extract" in a results table.

6.  **`"delete_table_row"`:** For removing a row from an existing table.
    *   `context` field: Use a SHORT, UNIQUE **table anchor** to identify the table (preferred: caption such as `"Table 7.4"` / `"Table 7.4 – ..."`; alternative: unique in-table value).
    *   `target` field: `""` (empty string).
    *   `tableCell` field: **REQUIRED** - Must specify which row to delete using `rowHeader` or `adjacentCells`.
    *   `replace` field: `""` (empty string - not used).
    *   **Warning**: Use with caution - deletion is immediate and cannot be easily undone.
    *   **Example**: Remove an obsolete equipment row from a table.

7.  **`"delete_section"`:** For removing an entire section of the document, including its heading and all content until the next heading of the same or higher level.
    *   `context` field: The EXACT text of the section heading (without numbers - e.g., "Internal Noise Assessment" not "8. Internal Noise Assessment").
    *   `target` field: `""` (empty string).
    *   `replace` field: `""` (empty string - not used).
    *   `headingLevel` field (optional): The heading level (1-9). If omitted, the tool will auto-detect the heading level.
    *   `adjacentSection` field (optional): For disambiguating when multiple sections have the same heading text. Use an object with:
        - `before`: Heading text of the section that appears immediately before this one
        - `after`: Heading text of the section that appears immediately after this one
    *   **Warning**: This deletes the heading paragraph AND all content up to (but not including) the next heading of equal or higher level. Use with caution.
    *   **Example**: Remove an entire "Limitations" section that's no longer relevant.

**Character Formatting Rules (for the "change" action):**
When replacing text, use the following HTML-style tags for formatting.
*   Subscript: `<sub>...</sub>` (e.g., `L<sub>Aeq</sub>`)
*   Superscript: `<sup>...</sup>` (e.g., `m<sup>2</sup>`)
*   Italic: `<i>...</i>` - **USE SPARINGLY, avoid in tables**
*   Bold: `<b>...</b>` - **USE SPARINGLY, avoid in tables**

---
**CRITICAL FOR TABLE IDENTIFICATION**

1. **Table Title as Primary Anchor (PREFERRED)**:
   - Use the `tableTitle` field inside `tableCell` to identify tables by their descriptive title (the text that appears BELOW the table).
   - **IMPORTANT**: Auto-generated field numbers like "Table 7.4" are NOT visible in the extracted text - use the descriptive title instead (e.g., `"BS4142 Assessment of Kitchen Extract Fan"`).
   - The `context` field should match the `tableTitle` for consistency.
   - If no descriptive title exists, use a unique value inside the table as the anchor.
   - Do **NOT** use generic headers such as `"Distance Loss"` or `"Results"` as the context—they often appear in multiple tables and will cause edits to target the wrong table.
   - Once the table is anchored via `tableTitle`, you may use generic row/column headers inside `tableCell` (e.g., `"rowHeader": "Distance Loss"`).

2. **Table Titles Are Reliable Anchors**:
   - Table titles appear as a paragraph directly below the table in the document.
   - Use the exact title text as it appears (e.g., `"Summary of Noise Assessment Results"`).
   - If the tool detects multiple tables with similar titles, it will prompt the user to select the correct one.

**CRITICAL RULES: AVOIDING UNNECESSARY FORMATTING CORRECTIONS**

1. The text you are reviewing is plain text converted from a formatted document. You cannot see the original formatting. Therefore, you **MUST NOT** suggest a change if the *only* correction is to add character formatting (sub, sup, bold, italic) to a term that is otherwise spelled and capitalized correctly. Only apply formatting as part of a fix for a genuine error (like a typo or a factual correction).

2. **NEVER add bold or italic formatting to table cells.** Tables already have their own formatting (header rows, borders, shading). Adding `<b>` or `<i>` tags will disrupt this formatting. When editing table cells, only change the text content, never add formatting tags.

---
**Constraint Checklist & Final Rules:**
1.  **JSON Only:** The entire output must be a single, valid JSON array.
2.  **Action Rules:** Follow the rules for the `replace` field for each `action` type.
3.  **Context is Verbatim:** The `context` string should match the text as closely as possible. The matching system will automatically normalize whitespace (tabs, non-breaking spaces, multiple spaces), smart quotes, and special characters, so minor variations in these will be handled. DO NOT include heading numbers in the context, only the text (DONT use "8. Internal Noise Assessment"), use ("Internal Noise Assessment").
    *   **TABLES:** Do NOT use `context` to encode a whole row using `|`. For tables, use `tableCell`.
    *   **TABLES (CRITICAL):** When a suggestion (or any sub-action) includes `tableCell`, its `context` MUST be a **unique table anchor** (preferred: caption like `"Table 7.4"` / `"Table 7.4 – ..."`; alternative: unique in-table value). Do not use generic row headers like `"Distance loss"` as `context`.
4.  **Keep target minimal:** The `target` string must be the minimal text that is required to locate the `target` block within the `context` block. For spelling corrections, this should typically be just the single misspelled word. For insertions/deletions, target the immediate surrounding phrase only.
5.  **Avoid Cosmetic Formatting:** Do not suggest formatting-only changes to correct terms.
6.  **Use Standard Characters Only:** Use standard ASCII quotes (`"`) and characters. No smart quotes in your JSON output.
7.  **Order:** The objects in the main JSON array must be in the order they appear in the original text to allow sequential search and find.
8.  **Escape Quotes:** If any string contains a quote, it must be escaped with a backslash (`\`).
9.  **Apply correct sub or post script to acoustic terms:** All acoustic terms must be subscript or superscript appropriately using HTML-style tags.
10. DO NOT change table numbers etc. These are auto forms.
11. DO NOT edit the contents list. This is an auto generated and updated form.

* NB: the script that applies the suggested changes in MS word runs in a single direction, looking forward only after finding a context and making a change. you may use this to judge the minimal, safe context text you can use to identify a context.

Additional guidance:
- Keep `context` minimal and unique; aim for ≤ 200 characters (shorter is better for granular tracking).
- **CRITICAL FOR TABLES**: When using `replace_with_table`, use the SHORTEST distinctive phrase from the table (e.g., a unique cell value or heading). NEVER include the entire table content in `context`.
- **CRITICAL FOR TABLE EDITS**: When editing individual cells in tables, use `"replace"` action, NOT `"replace_with_table"`. This preserves all table formatting (header colors, borders, column widths, etc.). Only use `replace_with_table` when completely restructuring a table.
- **NO FORMATTING IN TABLES**: When editing table cells, NEVER add `<b>`, `<i>`, or other formatting tags. Only change the text content. Tables have their own formatting that should not be disrupted.
- Keep `target` as specific as possible - ideally a single word or short phrase.
- Never include leading or trailing spaces in `context` or `target`.
- When the `target` repeats within the `context`, include `occurrenceIndex` (1-based).
- You may set `matchCase` at the suggestion level when case-sensitive matching is required. Do not include `matchCase` inside sub-actions.
- Do not rely on sub-action order; the tool applies a stable internal order as noted above.
- Ensure valid JSON; do not include trailing commas.

**High-Quality Examples:**

**Example 0: Minimal Target (BEST PRACTICE)**
```json
{
  "action": "change",
  "context": "The organiztion will meet tomorrow to discuss the proposal.",
  "target": "organiztion",
  "replace": "organization",
  "explanation": "Spelling correction: missing 'a'."
}
```
*Why this is good: The target is just the misspelled word. With granular tracking, reviewers will see only the letter 'a' inserted, not the whole word replaced.*

**Example 1: Simple Text Change**
```json
{
  "action": "change",
  "context": "The results indicates that the garden level is exceeded.",
  "target": "results indicates",
  "replace": "results indicate",
  "explanation": "Grammar: Subject-verb agreement error. 'Results' is plural."
}
```

**Example 2: Simple Table Replacement**
```json
{
  "action": "replace_with_table",
  "context": "Facade of House A",
  "target": "",
  "replace": "| Assessment Location | Criterion dB L<sub>Aeq</sub> | Predicted dB L<sub>Aeq</sub> |\n|---|---|---|\n| Facade of House A | 45 | 42 |\n| Garden of House B | 40 | 41 |",
  "explanation": "Converting comma-separated text into a structured, clear table. Using distinctive first row content to identify the table."
}
```

**Example 3: Compound Action (Style and Text Change)**
```json
{
  "context": "Results",
  "explanation": "Applying heading style and correcting text.",
  "actions": [
    {
      "action": "apply_heading_style",
      "target": "",
      "replace": "Heading 1"
    },
    {
      "action": "replace",
      "target": "Results",
      "replace": "Key Results"
    }
  ]
}
```

**Example 4: Compound Action (Change and Comment)**
```json
{
  "context": "The device is misconfigured, which poses a security risk.",
  "explanation": "Correcting typo and adding a comment for human review.",
  "actions": [
    {
      "action": "change",
      "target": "misconfigured",
      "replace": "mis-configured"
    },
    {
      "action": "comment",
      "target": "",
      "replace": "",
      "explanation": "Please verify the nature of this security risk and cite the relevant security policy."
    }
  ]
}

**Example 5: replace**
```json
{
  "action": "replace",
  "context": "The background LAeq was measured over 24 hours.",
  "target": "LAeq",
  "replace": "LA<sub>90</sub>",
  "explanation": "Correcting typo."
}
```

**Example 6: occurrenceIndex (repeated target)**
```json
{
  "action": "replace",
  "context": "Critical issues are critical to address.",
  "target": "critical",
  "occurrenceIndex": 2,
  "replace": "<b>critical</b>",
  "matchCase": false,
  "explanation": "Emphasize the second occurrence only."
}
```

**Example 7: matchCase (case-sensitive target)**
```json
{
  "action": "replace",
  "context": "Case matters here: abc Abc ABC",
  "target": "ABC",
  "replace": "Abc",
  "matchCase": true,
  "explanation": "Change only the uppercase variant to title case."
}
```

**Example 8: Word Insertion (Minimal Context)**
```json
{
  "action": "replace",
  "context": "The cat jumped over the fence.",
  "target": "The cat",
  "replace": "The black cat",
  "explanation": "Adding descriptive adjective for clarity."
}
```
*Why this is good: Minimal context (one sentence), minimal target (just the phrase being modified). Reviewers will see "black " inserted with granular tracking.*

**Example 9: AVOID - Overly Broad Context**
```json
// LESS IDEAL - Don't do this
{
  "action": "replace",
  "context": "The quick brown fox jumps over the lazy dog. The cat sat on the mat. The bird flew away.",
  "target": "brown",
  "replace": "red",
  "explanation": "Color correction"
}
```
*Why this is less ideal: Context is unnecessarily long. Use just "The quick brown fox jumps over the lazy dog." instead.*

**Example 10: Editing a Table Cell (BEST PRACTICE)**
```json
{
  "action": "replace",
  "context": "Summary of BS4142 Assessment Results",
  "tableCell": {
    "tableTitle": "Summary of BS4142 Assessment Results",
    "rowHeader": "Distance loss",
    "columnHeader": "Value",
    "adjacentCells": {
      "left": "Distance loss",
      "cellContent": "-20 dB (30m)"
    }
  },
  "target": "-20 dB (30m)",
  "replace": "-28 dB (78m)",
  "explanation": "Correcting distance loss calculation based on updated receptor distance of 78m."
}
```
*Why this is good: Uses the descriptive table title (which appears below the table) rather than auto-generated "Table 7.4" numbering. The tableTitle field makes identification deterministic. Note: NO bold or italic tags used - preserving existing table formatting.*

**Example 10b: What NOT to do in table cells**
```json
// BAD - Don't add formatting to table cells:
{
  "action": "replace",
  "context": "Noise Assessment Summary",
  "tableCell": {
    "tableTitle": "Noise Assessment Summary",
    "rowHeader": "Specific Sound Level",
    "columnHeader": "Value"
  },
  "target": "35 dB",
  "replace": "<b>26 dB</b>",
  "explanation": "Updating value"
}

// GOOD - Just change the text:
{
  "action": "replace",
  "context": "Noise Assessment Summary",
  "tableCell": {
    "tableTitle": "Noise Assessment Summary",
    "rowHeader": "Specific Sound Level",
    "columnHeader": "Value"
  },
  "target": "35 dB",
  "replace": "26 dB",
  "explanation": "Updating value"
}
```
*Why this matters: Tables have their own formatting system. Adding `<b>` tags to cells that weren't bold before disrupts the document's professional appearance.*

**CRITICAL: Table Cell Identification Strategy**

When identifying text within table cells, use the **tableCell** structure for precise, reliable location.

**DEPRECATION NOTICE:** Do NOT use pipe-delimited `context` strings (e.g., `"A | B | C"`) to represent table rows. This is slow and fragile in Word because Word tables do not contain literal `|` characters.

**Option 1: Simple table row pattern (RECOMMENDED for most cases)**
```json
{
  "action": "replace",
  "context": "BS4142 Assessment Results",
  "tableCell": {
    "tableTitle": "BS4142 Assessment Results",
    "rowHeader": "Distance loss",
    "columnHeader": "Value",
    "adjacentCells": {
      "left": "Distance loss",
      "right": ""
    }
  },
  "target": "-20 dB (30m)",
  "replace": "-28 dB (78m)",
  "explanation": "Correcting distance calculation."
}
```

**Option 2: Full adjacent cell context (BEST for disambiguation)**
```json
{
  "action": "replace",
  "context": "Predicted Noise Levels at Receptors",
  "tableCell": {
    "tableTitle": "Predicted Noise Levels at Receptors",
    "rowHeader": "Facade of House A",
    "columnHeader": "Predicted Level",
    "adjacentCells": {
      "above": "Predicted dB LAeq",
      "left": "45 dB",
      "cellContent": "42 dB"
    }
  },
  "target": "42 dB",
  "replace": "44 dB",
  "explanation": "Updated prediction based on revised model."
}
```

**tableCell Structure Fields:**
- `tableTitle` (RECOMMENDED): The exact title text that appears BELOW the table (e.g., "Summary of BS4142 Assessment Results"). This is the most reliable way to identify a table. NOTE: Do NOT use auto-generated field numbers like "Table 7.4" as these are not visible in the extracted text - use the descriptive title text instead.
- `rowHeader` (optional): Text from the first cell in the row (row header)
- `columnHeader` (optional): Text from the column header
- `adjacentCells` (optional): Object containing:
  - `above`: Text in the cell directly above
  - `below`: Text in the cell directly below
  - `left`: Text in the cell directly to the left
  - `right`: Text in the cell directly to the right
  - `cellContent`: The actual content of the target cell (for verification)
- BEST PRACTICE: Always include `tableTitle` for table edits. Use rowHeader/columnHeader/adjacentCells to identify the specific cell within that table.

**Hard requirements for deterministic table edits:**
1. Include `tableCell` for any change inside a table.
2. Include `rowHeader` AND `columnHeader` whenever possible.
3. If there is any ambiguity (repeated row headers or repeated values), include `adjacentCells.cellContent` and at least one of `adjacentCells.left/right/above/below`.
4. `adjacentCells.left/right/above/below` must describe the neighboring cells. Do NOT put the target text/value into `left/right/above/below`.
5. Use `adjacentCells.cellContent` ONLY as a verification hint for the target cell's current contents.

**Robustness rules for imperfect table extraction (PDF/OCR/merged cells):**
1. If the table has merged headers, multi-row headers, or irregular columns, DO NOT rely on `columnHeader` alone.
2. Always include at least TWO independent anchors:
   - `rowHeader` (preferred)
   - `adjacentCells.left` or `adjacentCells.above`
   - `adjacentCells.cellContent` (verification)
3. If you are unsure which column a value belongs to, omit `columnHeader` and instead use `adjacentCells` plus `cellContent`.
4. Keep `context` as a **unique table anchor** (preferred: caption like `"Table 7.4"` / `"Table 7.4 – ..."`; alternative: unique in-table value). Do not use generic row headers as `context`.

**When to use tableCell:**
1. When editing values within a table
2. When the context text contains characters that might be ambiguous (commas, pipes, special formatting)
3. When you need to identify a specific cell in a large table
4. When the same value appears in multiple cells

**How the tool uses tableCell:**
1. First uses `context` to locate the correct table (caption is best).
2. Then uses `tableCell` to locate the exact cell within that table.
3. Verifies the cell content matches if provided
4. Uses adjacentCells to disambiguate when multiple matches exist
5. Falls back to regular context matching if table structure not found

**Example 11: When to Replace Entire Table vs. Edit Cells**
```json
// GOOD - Multiple small changes in same table? Edit each cell individually:
[
  {
    "action": "replace",
    "context": "Dwellings to North",
    "target": "Dwellings to North",
    "replace": "Dwellings to West",
    "explanation": "Correcting receptor direction."
  },
  {
    "action": "replace",
    "context": "Distance loss | -20 dB (30m)",
    "target": "-20 dB (30m)",
    "replace": "-28 dB (78m)",
    "explanation": "Updating distance loss for 78m distance."
  },
  {
    "action": "replace",
    "context": "Background sound level | LA90 40 dB",
    "target": "LA90 40 dB",
    "replace": "LA90 58 dB",
    "explanation": "Using correct background level for west position."
  }
]

// LESS IDEAL - Don't replace entire table unless structure changes:
// Only use replace_with_table if you're adding/removing columns, changing table structure,
// or replacing more than ~50% of the cell values
```
*Why individual edits are better: Each change is tracked separately, making it easy for reviewers to see what changed and why. The granular diff feature shows character-level changes within each cell.*

**Example 12: Better Table Replacement Context**
```json
// GOOD - Use minimal, distinctive context to identify the table:
{
  "action": "replace_with_table",
  "context": "Dwellings to South",
  "target": "",
  "replace": "| Results | Dwellings to East | Relevant Clause | Commentary |\n|---|---|---|---|\n| Extract Fan | L<sub>Aeq</sub> 55 dB @ 3m | | Normal operating speed |",
  "explanation": "The tool will search for 'Dwellings to South' and automatically detect it's within a table, then replace the entire table."
}

// AVOID - Don't include the entire table in context:
{
  "action": "replace_with_table",
  "context": "Results,Dwellings to South,Relevant Clause,Commentary\nExtract Fan,LAeq 55 dB @ 3m,,Normal operating speed\n...[hundreds of characters]...",
  "target": "",
  "replace": "...",
  "explanation": "This long context is hard to match and prone to whitespace/formatting mismatches."
}
```
*Why short context works: The VBA code checks if the found context is within a table (line 1287: `wasInTable = targetRange.Information(wdWithinTable)`), then automatically deletes the entire table and replaces it. You only need enough context to find the right table.*

**Example 13: Disambiguating Multiple Similar Tables**
```json
// When multiple tables contain similar content, use a UNIQUE cell value to identify each:
{
  "action": "replace_with_table",
  "context": "LAeq 55 dB @ 3m",
  "target": "",
  "replace": "...",
  "explanation": "Using '55 dB @ 3m' to identify the Kitchen Extract table (vs Battery table with 60dB @ 1m)"
}

// Alternative: Use table caption if it appears in the document:
{
  "action": "replace_with_table",
  "context": "Table 6.3",
  "target": "",
  "replace": "...",
  "explanation": "Using table number to uniquely identify the Kitchen Extract table"
}
```
*Best practice: When documents have multiple similar tables, find a cell value that's unique to each table (like different equipment specifications) rather than shared values like column headers.*

**Example 14: Inserting a Table Row**
```json
{
  "action": "insert_table_row",
  "context": "BS4142 Assessment of Kitchen Extract Fan",
  "tableCell": {
    "tableTitle": "BS4142 Assessment of Kitchen Extract Fan",
    "rowHeader": "Distance loss",
    "adjacentCells": {
      "above": "Assume 60 minutes / hour"
    }
  },
  "target": "",
  "replace": "Barrier attenuation|-5 dB||Acoustic barrier present",
  "insertPosition": "after",
  "explanation": "Adding barrier attenuation row after distance loss in Kitchen Extract assessment table."
}
```
*How this works: Uses the tableTitle to locate the correct table, finds the "Distance loss" row, inserts a new row after it, copies formatting from the row above, and populates cells with pipe-separated values.*

**Example 15: Deleting a Table Row**
```json
{
  "action": "delete_table_row",
  "context": "BS4142 Assessment of Battery Storage System",
  "tableCell": {
    "tableTitle": "BS4142 Assessment of Battery Storage System",
    "rowHeader": "Acoustic feature",
    "adjacentCells": {
      "above": "Specific Sound Level"
    }
  },
  "target": "",
  "replace": "",
  "explanation": "Removing acoustic feature correction row as it's no longer applicable for this source."
}
```
*Why use this: Uses the descriptive tableTitle to reliably identify the correct table, then removes the specified row. The table automatically adjusts, and formatting of surrounding rows is preserved.*

**Example 16: Deleting a Section (Simple)**
```json
{
  "action": "delete_section",
  "context": "Limitations and Assumptions",
  "target": "",
  "replace": "",
  "explanation": "Removing Limitations section as the revised methodology no longer requires these caveats."
}
```
*How this works: Finds the heading "Limitations and Assumptions" (ignoring auto-numbering like "7."), detects its heading level (e.g., Heading 2), then deletes everything from that heading through the end of the section (stops before the next Heading 2 or Heading 1).*

**Example 17: Deleting a Section (Disambiguation)**
```json
{
  "action": "delete_section",
  "context": "Methodology",
  "target": "",
  "replace": "",
  "adjacentSection": {
    "before": "Background Survey",
    "after": "Results"
  },
  "explanation": "Removing the second Methodology section (the one between Background Survey and Results) as it duplicates content from Section 3."
}
```
*Why disambiguation is needed: If a document has multiple sections with the same heading text (e.g., "Methodology" appearing in different chapters), use adjacentSection to specify which one. The tool will verify the heading appears between the specified sections.*
